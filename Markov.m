
%% Bfen
% 0
% 1
% 10
% 11
% 101

I=[1 0 0 0 0 ];
%  A    B   C       D    E 
J=[1/2   0  1/8    2/8   1/8;
    0    0   0      0     0;
    1    0   0      0     0;
   1/2   0  1/8    2/8   1/8;
   1/2   0  1/8    2/8   1/8;];
inter=20;
dr2=zeros(1,inter);
K=I*J
dr2(1)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));

for i=2:inter
    K=K*J
    dr2(i)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));
end

E=K(5)/(K(1)+K(2)+K(3)+K(4)+K(5))
D=K(4)/(K(1)+K(2)+K(3)+K(4)+K(5))
C=K(3)/(K(1)+K(2)+K(3)+K(4)+K(5))
B=K(2)/(K(1)+K(2)+K(3)+K(4)+K(5))
A=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5))
L=A*1+B*1+C*2+D*2+E*3
figure
hold on
plot((1:inter),dr2,'r-o');
% 0.5625*  1/2   +  0.1094* 1 +  0.2188* 1/2  +  0.1094*1/2
%% S分两路A全
% 0
% 1
% 10
% 101
% 1010

I=[1 0 0 0 0];
%  A       B      C       D     E 
J=[8/16   4/16  2/16    1/16   1/16;
    0      4/8   2/8     1/8   1/8;
    1        0     0       0     0;
    0      4/8   2/8      1/8   1/8;
   8/16   4/16  2/16    1/16   1/16;];
inter=20;
dr3=zeros(1,inter);
K=I*J
dr3(1)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));

for i=2:inter
    K=K*J
    dr3(i)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));
end

E=K(5)/(K(1)+K(2)+K(3)+K(4)+K(5))
D=K(4)/(K(1)+K(2)+K(3)+K(4)+K(5))
C=K(3)/(K(1)+K(2)+K(3)+K(4)+K(5))
B=K(2)/(K(1)+K(2)+K(3)+K(4)+K(5))
A=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5))
L=A*1+B*1+C*2+D*3+E*4
hold on
plot((1:inter),dr3,'b-.');

%% Cfen

% 0
% 1
% 10
% 101
% 100

I=[1 0 0 0 0];
%  A    B   C       D    E 
J=[4/8   2/8  0    1/8   1/8;
    0    2/4   0   1/4   1/4;
    0    0   0      0     0;
   4/8   2/8  0    1/8   1/8;
   4/8   2/8  0    1/8   1/8;];
inter=20;
dr1=zeros(1,inter);
K=I*J
dr1(1)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));

for i=2:inter
    K=K*J;
    dr1(i)=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5));
end

E=K(5)/(K(1)+K(2)+K(3)+K(4)+K(5))
D=K(4)/(K(1)+K(2)+K(3)+K(4)+K(5))
C=K(3)/(K(1)+K(2)+K(3)+K(4)+K(5))
B=K(2)/(K(1)+K(2)+K(3)+K(4)+K(5))
A=K(1)/(K(1)+K(2)+K(3)+K(4)+K(5))
L=A*1+B*1+C*2+D*3+E*3

hold on
plot((1:inter),dr1,'g-+');
%%
xlabel('k-step transition');
ylabel('\pi(1)');
legend('DESG1','DESG2','DESG3');